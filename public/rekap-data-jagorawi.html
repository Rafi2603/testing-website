<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <title>Dashboard K3 - Struktur Organisasi</title>
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <!-- DataTables CSS -->
    <link href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.min.css" rel="stylesheet">
    
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <!-- DataTables CSS -->
    <link href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.min.css" rel="stylesheet">
    
    <style nonce="<%= nonce %>">

        /* Tombol scroll-up di pojok kanan bawah */
        #scrollUpButton {
            display: none; /* Sembunyikan tombol secara default */
            position: fixed; /* Posisi tetap di pojok kanan bawah */
            bottom: 20px; /* Jarak dari bawah layar */
            right: 20px; /* Jarak dari kanan layar */
            z-index: 99; /* Pastikan tombol berada di atas elemen lainnya */
            background-color: #007bff; /* Warna tombol (biru) */
            color: white; /* Warna teks */
            border: none; /* Hilangkan border */
            outline: none; /* Hilangkan outline */
            width: 50px; /* Lebar tombol */
            height: 50px; /* Tinggi tombol */
            border-radius: 50%; /* Bentuk bulat */
            text-align: center;
            font-size: 18px; /* Ukuran font untuk ikon panah */
            cursor: pointer; /* Tampilkan pointer */
            box-shadow: 2px 2px 5px #0000004d; /* Sedikit bayangan */
        }

        #scrollUpButton:hover {
            background-color: #0056b3; /* Ubah warna saat hover */
        }
        
.organization-container {
    display: grid;
    grid-template-columns: repeat(5, 1fr); /* Buat 5 kolom */
    grid-gap: 20px;
    text-align: center;
    margin: 20px;
}

.ketua, .sekretaris, .anggota1, .anggota2, .anggota3, .anggota4, .anggota5 {
    border: 2px solid #0056b3;
    padding: 15px;
    font-weight: bold;
    border-radius: 12px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    transition: transform 0.10s ease, box-shadow 0.10s ease;
}

.ketua {
    grid-column: 3 / 4; /* Ketua berada di kolom tengah */
    background-color: #f8d7da; /* Warna latar merah muda */
    color: #721c24;
}

.sekretaris {
    grid-column: 3 / 4; /* Sekretaris berada di kolom tengah */
    background-color: #cce5ff; /* Warna latar biru muda */
    color: #004085;
}

/* Membuat anggota sejajar */
.anggota1, .anggota2, .anggota3, .anggota4, .anggota5 {
    background-color: #d4edda; /* Warna latar hijau muda */
    color: #155724;
}

.anggota1 { grid-column: 1; }
.anggota2 { grid-column: 2; }
.anggota3 { grid-column: 3; }
.anggota4 { grid-column: 4; }
.anggota5 { grid-column: 5; }

/* Efek hover */
.ketua:hover, .sekretaris:hover, .anggota1:hover, .anggota2:hover, .anggota3:hover, .anggota4:hover, .anggota5:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
}

/* Responsif untuk layar lebih kecil */
@media (max-width: 768px) {
    .organization-container {
        grid-template-columns: repeat(2, 1fr); /* Ubah jadi 2 kolom */
    }

    .ketua, .sekretaris {
        grid-column: span 2; /* Membuat mereka full width */
    }
}

@media (max-width: 480px) {
    .organization-container {
        grid-template-columns: 1fr; /* Ubah jadi 1 kolom */
    }

    .ketua, .sekretaris, .anggota1, .anggota2, .anggota3, .anggota4, .anggota5 {
        grid-column: span 1;
    }
}

h1, h2 {
    text-align: center;
    font-family: Arial, sans-serif;
    color: #0056b3;
}



        @font-face {
            font-family: 'Amonos Display';
            src: url('Fonts/amonosdisplay-regular.otf') format('truetype');
            font-weight: 10000; /* Extra Bold */
            
        }

        h1 {
            font-family: 'Amonos Display', sans-serif;
            font-weight: 800;
            color: #0056b3;
            font-size: 30px; /* Ukuran font */

        }
        body {
            background-color: #f0f2f5;
            font-family: Arial, sans-serif;
        }
    
        .container {
            margin-top: 20px;
        }
    
        /* Custom navbar styles */
        .navbar-custom {
            background-color: #FFD700; /* Kuning */
            border-radius: 10px; /* Add rounded corners to navbar */
            padding: 10px 20px; /* Add padding for a better look */
        }
    
        .navbar-custom .nav-link {
            color: #0056b3; /* Biru */
            font-weight: bold;
            border-radius: 5px; /* Round the navbar items */
            padding: 10px 15px; /* Add padding to navbar items */
            transition: background-color 0.3s; /* Smooth transition for hover effect */
        }
    
        .navbar-custom .nav-link:hover {
            color: #fff; /* Change text color on hover */
            background-color: #003c82; /* Background color on hover */
        }
    
        .navbar-custom .navbar-brand {
            color: #0056b3; /* Biru */
            font-weight: bold;
            border-radius: 5px; /* Round the brand item */
        }
    
        .navbar-custom .navbar-brand:hover {
            color: #fff; /* Change color on hover */
        }
    
        /* Custom button styles */
        .btn-custom {
            background-color: #5998d6;
            color: #fff;
            border: none;
            font-weight: bold;
            border-radius: 5px; /* Round the custom buttons */
            padding: 10px 15px; /* Add padding to buttons */
        }
    
        .btn-custom:hover {
            background-color: #003c82;
        }
    
        .navbar-toggler {
            border-color: #fff;
            border-radius: 5px; /* Round the toggle button */
        }
    
        /* Logo */
        .navbar-brand img {
            height: 60px;
            width: auto;
        }
    
        /* Custom table header styles */
        table thead th {
            background-color: #0056b3;
            color: white;
            text-align: center;
        }
    
        table tbody td {
            text-align: center;
        }
    
        /* Custom export button styles */
        #export-button, #export-buttonPersonel, #export-buttonKecelakaan,
        #export-buttonKejadian{
            background-color: #ffd900;
            color: #0056b3;
            font-weight: bold;
            border-radius: 5px; /* Round export buttons */
            padding: 10px 15px; /* Add padding to export buttons */
        }
    
        #export-button:hover, #export-buttonPersonel:hover, #export-buttonKecelakaan:hover,
        #export-buttonKejadian:hover, #export-buttonStruktur:hover {
            background-color: #ffcc00;
        }
    
    </style>
</head>
<body>



    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-custom">
        
        <a class="navbar-brand" href="#">
            <img src="jmto=logo-png.png" alt="Logo Perusahaan"> <!-- Logo Perusahaan -->
            
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        
        <div class="collapse navbar-collapse" id="navbarNav">
            <h1>JAGORAWI</h1>
            <ul class="navbar-nav mx-auto">
                <li class="nav-item">
                    <a class="nav-link" href="#rekapData">Rekap Data K3</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#personelK3Data">Personel K3</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#kecelakaanKerja">Kecelakaan Kerja</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#kejadiannKerja">Kejadian Darurat</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#checklistk3">Checklist K3</a>
                </li>
                <li class="nav-item">
                    <a id="logoutbutton" class="nav-link btn btn-custom" href="https://testing-website-rafi-fauzans-projects.vercel.app/index.html">Log Out</a>
                </li>
            </ul>
        </div>
    </nav>
    <!-- End of Navbar -->


    <div class="container-fluid">
        <h2 style="text-align: center;"> 
            <span style="display: inline-block; width: 100%; border-bottom: none; margin-bottom: 20px;"></span>
        </h2>
        
        
        <h2 style="color: #000000; border: 3px solid #0056b3; padding: 15px; font-size: 1.8em; font-family: 'Arial', sans-serif; display: block; width: 100%; text-align: center; border-radius: 50px;">
            <span style="padding: 0 10px;">ðŸ“‹</span> Struktur Organisasi P2K3 JAGORAWI
        </h2>
        
        <div class="mb-4 text-center">
            <!-- Button to navigate to Update Data Page -->
            <a href="https://testing-website-rafi-fauzans-projects.vercel.app/update-struktur-jagorawi.html" class="btn btn-warning">Update Struktur</a>
            <button class="btn btn-success" id="export-buttonStruktur">Export to Excel</button>
        </div>

        <div class="organization-container">
            <!-- Ketua -->
            <div class="ketua">KETUA</div>

            <!-- Sekretaris -->
            <div class="sekretaris">SEKRETARIS</div>
        
            <!-- Anggota -->
            <div class="anggota1">ANGGOTA 1</div>
            <div class="anggota2">ANGGOTA 2</div>
            <div class="anggota3">ANGGOTA 3</div>
            <div class="anggota4">ANGGOTA 4</div>
            <div class="anggota5">ANGGOTA 5</div>
        </div>
        
        <table id="struktur-organisasi-table" class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>No</th>
                    <th>Nama</th>
                    <th>Jabatan</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>


        <!-- Rekap Data K3 Table -->
        <h2 style="text-align: center;"> 
            <span style="display: inline-block; width: 100%; border-bottom: none; margin-bottom: 20px;"></span>
        </h2>
        

        <h2 id="rekapData" style="color: #000000; border: 3px solid #0056b3; padding: 15px; font-size: 1.8em; font-family: 'Arial', sans-serif; display: block; width: 100%; text-align: center; border-radius: 50px;">
            <span  style="padding: 0 10px;">ðŸ“‹</span> Rekap Data K3 JAGORAWI
        </h2>

        
        <div class="mb-4 text-center">
            <!-- Button to navigate to Add Data Page -->
            <a href="https://testing-website-rafi-fauzans-projects.vercel.app/add-data-jagorawi.html" class="btn btn-primary">Tambah Data Baru</a>
            <!-- Button to navigate to Update Data Page -->
            <a href="https://testing-website-rafi-fauzans-projects.vercel.app/update-data-jagorawi.html" class="btn btn-warning">Update Data</a>
            <!-- Button to show delete modal -->
            <button class="btn btn-danger" onclick="showDeleteModalData()">Hapus Data</button>
            <button class="btn btn-success" id="export-button">Export to Excel</button>
        </div>
    
<!-- Modal Konfirmasi Hapus -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteModalLabel">Konfirmasi Penghapusan</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Apakah Anda yakin ingin menghapus data ini?
                <form id="deleteForm">
                    <div class="form-group mb-3">
                        <label for="tahun" class="form-label">Tahun</label>
                        <input type="number" class="form-control" id="tahun" name="tahun" required>
                    </div>
                    <div class="form-group mb-3">
                        <label for="bulan" class="form-label">Bulan</label>
                        <select class="form-control" id="bulan" name="bulan" required>
                            <option value="" disabled selected>Pilih Bulan</option>
                            <option value="January">January</option>
                            <option value="February">February</option>
                            <option value="March">March</option>
                            <option value="April">April</option>
                            <option value="May">May</option>
                            <option value="June">June</option>
                            <option value="July">July</option>
                            <option value="August">August</option>
                            <option value="September">September</option>
                            <option value="October">October</option>
                            <option value="November">November</option>
                            <option value="December">December</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Batal</button>
                <button type="button" class="btn btn-danger" onclick="deleteData()">Hapus</button>
            </div>
        </div>
    </div>
</div>
    

<!-- Year selection dropdown -->
<div class="form-group">
    <label for="yearSelect">Pilih Tahun:</label>
    <select id="yearSelect" class="form-control" onchange="filterTableByYear()">
        <option value="" selected>Semua Tahun</option>
        <!-- Add options dynamically through JavaScript or hardcode specific years -->
    </select>
</div>

    <div style="overflow-x: auto;">
        <table id="data-table" class="table table-striped table-bordered table-hover">
            <thead>
                <tr>
                    <th rowspan="2">No</th>
                    <th rowspan="2">Tahun</th>
                    <th rowspan="2">Bulan</th>
                    <th colspan="2">Jumlah Karyawan</th>
                    <th colspan="2">Jumlah Hari Kerja</th>
                    <th rowspan="2">Jumlah Jam Kerja</th>
                    <th colspan="2">Kecelakaan Berat</th>
                    <th colspan="2">Kecelakaan Ringan</th>
                    <th colspan="2">Kecelakaan Meninggal</th>
                    <th colspan="2">Near Miss</th>
                    <th rowspan="2">Fire Accident</th>
                    <th rowspan="2">Damaged Property</th>
                    <th colspan="2">Jumlah Hari Hilang</th>
                    <th colspan="2">Jumlah Hari Tanpa Hilang</th>
                    <th colspan="2">LTI</th>
                    <th colspan="2">Man Hour</th>
                    <th rowspan="2">Frequency Rate (FR)</th>
                    <th rowspan="2">Severity Rate (SR)</th>
                    <th rowspan="2">Inchident Rate (SR)</th>
                    <th rowspan="2">Average Time Lost Injury (ATLR)</th>
                </tr>
                <tr>
                    <th>OPS</th>
                    <th>Non-OPS</th>
                    <th>OPS</th>
                    <th>Non-OPS</th>
                    <th>OPS</th>
                    <th>Non-OPS</th>
                    <th>OPS</th>
                    <th>Non-OPS</th>
                    <th>OPS</th>
                    <th>Non-OPS</th>
                    <th>OPS</th>
                    <th>Non-OPS</th>
                    <th>OPS</th>
                    <th>Non-OPS</th>
                    <th>OPS</th>
                    <th>Non-OPS</th>
                    <th>OPS</th>
                    <th>Non-OPS</th>
                    <th>OPS</th>
                    <th>Non-OPS</th>
                </tr>
            </thead>
            <tbody>
                <!-- Data tabel akan diisi oleh script.js -->
            </tbody>
        </table>
    </div>

        <!-- Keterangan setelah tabel -->
        <div class="keterangan">
            <h4>Keterangan:</h4>
            <ul>
                <li><strong>Jumlah Hari Kerja</strong> adalah Jumlah Hari Kerja Efektif dalam 1 bulan tidak termasuk libur
                    <ul>
                        <li>Jika hari kerja Karyawan Operasional dan Non Operasional berbeda, bisa dihitung rata-ratanya.</li>
                    </ul>
                </li>
                <li><strong>Kehilangan waktu kerja</strong> dimana tenaga kerja tidak mampu bekerja kembali pada shift normal berikutnya sesuai jadwal kerja.
                    <ul>
                        <li>Perhitungan keseluruhan jam kerja dimulai sejak terjadinya kecelakaan kerja (insiden) yang dapat mengakibatkan angka perhitungan jam kerja menjadi 0 (nol) yaitu kriteria kecelakaan kerja yang menghilangkan waktu kerja, dan bertambah secara kumulatif sesuai jam kerja yang dicapai.</li>
                        <li>Perhitungan jam kerja keseluruhan meliputi semua jam kerja nyata tenaga kerja yang melaksanakan kegiatan perusahaan pada masing-masing bidang pekerjaan.</li>
                    </ul>
                </li>
            </ul>
        </div>
    
    


        <!-- Personel K3 Data Table -->
        <h2 style="text-align: center;"> 
            <span style="display: inline-block; width: 100%; border-bottom: none; margin-bottom: 20px;"></span>
        </h2>
        

        <h2 id="personelK3Data" style="color: #000000; border: 3px solid #0056b3; padding: 15px; font-size: 1.8em; font-family: 'Arial', sans-serif; display: block; width: 100%; text-align: center; border-radius: 50px;">
            <span style="padding: 0 10px;">ðŸ“‹</span> Rekap Personel K3 JAGORAWI
        </h2>
        
        <div class="mb-4 text-center">
            <a href="https://testing-website-rafi-fauzans-projects.vercel.app/add-personel-k3-jagorawi.html" class="btn btn-primary">Tambah Data Baru</a>
            <a href="https://testing-website-rafi-fauzans-projects.vercel.app/update-personel-k3-jagorawi.html" class="btn btn-warning">Update Data</a>
            <button class="btn btn-danger" onclick="showDeleteModalPersonel()">Hapus Data</button>
            <button class="btn btn-success" id="export-buttonPersonel" class="btn btn-primary mb-3">Export to Excel</button>
        </div>

        <!-- Modal Konfirmasi Hapus -->
        <div class="modal fade" id="deleteModalPersonel" tabindex="-1" aria-labelledby="deleteModalLabelPersonel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deleteModalLabelPersonel">Konfirmasi Penghapusan</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                    </div>
            <div class="modal-body">
                Apakah Anda yakin ingin menghapus data ini?
                <form id="deleteForm">
                    <div class="form-group">
                        <label for="personel_k3_id">Masukkan ID/No data:</label>
                        <input type="number" class="form-control" id="personel_k3_id" placeholder="Masukkan ID atau No data yang ingin dihapus">
                    </div>
                </form>
            </div>
                    <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-danger" onclick="deletePersonel()">Hapus</button>
                    </div>
                </div>
            </div>
        </div>


        <table id="personel-k3-table" class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>No</th>
                    <th>Nama</th>
                    <th>Role</th>
                    <th>Batas Masa Berlaku</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <!-- Rekap Data Kecelakaan Kerja Table -->
        <h2 style="text-align: center;"> 
            <span style="display: inline-block; width: 100%; border-bottom: none; margin-bottom: 20px;"></span>
        </h2>
        

        <h2 id="kecelakaanKerja" style="color: #000000; border: 3px solid #0056b3; padding: 15px; font-size: 1.8em; font-family: 'Arial', sans-serif; display: block; width: 100%; text-align: center; border-radius: 50px;">
            <span style="padding: 0 10px;">ðŸ“‹</span> Rekap Data Kecelakaan Kerja JAGORAWI
        </h2>
        
        <div class="mb-4 text-center">
            <a href="https://testing-website-rafi-fauzans-projects.vercel.app/add-kecelakaan-jagorawi.html" class="btn btn-primary">Tambah Data Baru</a>
            <a href="https://testing-website-rafi-fauzans-projects.vercel.app/update-kecelakaan-jagorawi.html" class="btn btn-warning">Update Data</a>
            <button class="btn btn-danger" onclick="showDeleteModalKecelakaan()">Hapus Data</button>
            <button class="btn btn-success" id="export-buttonKecelakaan" class="btn btn-primary mb-3">Export to Excel</button>
        </div>


        <!-- Modal Konfirmasi Hapus -->
        <div class="modal fade" id="deleteModalKecelakaan" tabindex="-1" aria-labelledby="deleteModalKecelakaan" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deleteModalLabelKecelakaan">Konfirmasi Penghapusan</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                    </div>
            <div class="modal-body">
                Apakah Anda yakin ingin menghapus data ini?
                <form id="deleteForm">
                    <div class="form-group">
                        <label for="kecelakaan_kerja_id">Masukkan ID/No data:</label>
                        <input type="number" class="form-control" id="kecelakaan_kerja_id" placeholder="Masukkan ID atau No data yang ingin dihapus">
                    </div>
                </form>
            </div>
                    <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-danger" onclick="deleteKecelakaan()">Hapus</button>
                    </div>
                </div>
            </div>
        </div>

    
        <table id="kecelakaan-kerja-table" class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>No</th>
                    <th>Tanggal</th>
                    <th>NIK</th>
                    <th>Nama</th>
                    <th>Jabatan</th>
                    <th>Ruas</th>
                    <th>Kronologis</th>
                    <th>Kategori Kecelakaan</th>
                    <th>Tindak Lanjut</th>
                    <th>Perawatan di RS</th>
                </tr>
            </thead>
            <tbody>
                <!-- Data kecelakaan kerja akan diisi oleh script -->
            </tbody>
        </table>

       <!-- Rekap Data Kejadian Darurat Table -->
    <h2  style="text-align: center;"> 
        <span style="display: inline-block; width: 100%; border-bottom: none; margin-bottom: 20px;"></span>
    </h2>
    
    <h2 id="kejadiannKerja" style="color: #000000; border: 3px solid #0056b3; padding: 15px; font-size: 1.8em; font-family: 'Arial', sans-serif; display: block; width: 100%; text-align: center; border-radius: 50px;">
        <span style="padding: 0 10px;">ðŸ“‹</span> Rekap Data Kejadian Darurat JAGORAWI
    </h2>
    
        <div class="mb-4 text-center">
            <a href="https://testing-website-rafi-fauzans-projects.vercel.app/add-kejadian-jagorawi.html" class="btn btn-primary">Tambah Data Baru</a>
            <a href="https://testing-website-rafi-fauzans-projects.vercel.app/update-kejadian-jagorawi.html" class="btn btn-warning">Update Data</a>
            <button class="btn btn-danger" onclick="showDeleteModalKejadian()">Hapus Data</button>
            <button class="btn btn-success" id="export-buttonKejadian" class="btn btn-primary mb-3">Export to Excel</button>
        </div>

 <!-- Modal Konfirmasi Hapus -->
<div class="modal fade" id="deleteModalKejadian" tabindex="-1" aria-labelledby="deleteModalLabelKejadian" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteModalLabelKejadian">Konfirmasi Penghapusan</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Apakah Anda yakin ingin menghapus data ini?
                <form id="deleteForm">
                    <div class="form-group">
                        <label for="kejadian_darurat_id">Masukkan ID/No data:</label>
                        <input type="number" class="form-control" id="kejadian_darurat_id" placeholder="Masukkan ID atau No data yang ingin dihapus" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Batal</button>
                <button type="button" class="btn btn-danger" onclick="deleteKejadian()">Hapus</button>
            </div>
        </div>
    </div>
</div>

        <table id="kejadian-kerja-table" class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>No</th>
                    <th>Kejadian Darurat</th>
                    <th>Lokasi</th>
                    <th>Kronologi Kejadian</th>
                    <th>Tindak Lanjut</th>
                    <th>Evidence</th>
                </tr>
            </thead>
            <tbody>
                <!-- Data kecelakaan kerja akan diisi oleh script -->
            </tbody>
        </table>

<!-- Keterangan setelah tabel -->
<div class="keterangan">
    <h4>Keterangan:</h4>
    <ul>
        <li>Konsleting listrik yang mengakibatkan timbulnya bahaya seperti terdapat percikan api atau konsleting listrik yang menyebabkan padamnya aliran listrik sehingga mengganggu proses kerja.</li>
        <li>Banjir yang dapat menghambat kelancaran proses kerja dan terjadi di sekitar area kerja operasional atau non operasional.</li>
        <li>Kebakaran yang terjadi di sekitar area kerja operasional atau non operasional.</li>
        <li>Kerusakan pada area sekitar tempat kerja seperti contoh kerusakan pada bagian buhul-buhul gerbang yang membahayakan dan dapat menimpa karyawan atau pengguna jalan yang melintas.</li>
        <li>Huru-hara yang terjadi di sekitar area kerja yang menyebabkan terhambatnya proses kerja.</li>
        <li>Dan lain-lain kejadian darurat yang menyebabkan bahaya di sekitar tempat area kerja.</li>
    </ul>
</div>


            <!-- Rekap Checklist K3 Table -->
            <h2 style="text-align: center;"> 
                <span style="display: inline-block; width: 100%; border-bottom: none; margin-bottom: 20px;"></span>
            </h2>
            
    
            <h2 id="checklistk3" style="color: #000000; border: 3px solid #0056b3; padding: 15px; font-size: 1.8em; font-family: 'Arial', sans-serif; display: block; width: 100%; text-align: center; border-radius: 50px;">
                <span style="padding: 0 10px;">ðŸ“‹</span> Rekap Checklist K3  JAGORAWI
            </h2>
            
            <div class="mb-4 text-center">
                <a href="https://testing-website-rafi-fauzans-projects.vercel.app/add-checklist-jagorawi.html" class="btn btn-primary">Tambah Data Baru</a>
                <a href="https://testing-website-rafi-fauzans-projects.vercel.app/update-checklist-jagorawi.html" class="btn btn-warning">Update Data</a>
                <button class="btn btn-danger" onclick="showDeleteModalChecklist()">Hapus Data</button>
                <button class="btn btn-success" id="export-buttonChecklist" class="btn btn-primary mb-3">Export to Excel</button>
            </div>
    
    
            <!-- Modal Konfirmasi Hapus -->
            <div class="modal fade" id="deleteModalChecklist" tabindex="-1" aria-labelledby="deleteModalChecklist" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="deleteModalLabelChecklist">Konfirmasi Penghapusan</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                        </div>
                <div class="modal-body">
                    Apakah Anda yakin ingin menghapus data ini?
                    <form id="deleteForm">
                        <div class="form-group">
                            <label for="checklist_id">Masukkan ID/No data:</label>
                            <input type="number" class="form-control" id="checklist_id" placeholder="Masukkan ID atau No data yang ingin dihapus">
                        </div>
                    </form>
                </div>
                        <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Batal</button>
                        <button type="button" class="btn btn-danger" onclick="deleteChecklist()">Hapus</button>
                        </div>
                    </div>
                </div>
            </div>  

            <!-- Year selection dropdown -->
            <div class="form-group">
                <label for="sectionSelect">Pilih Section:</label>
                <select id="sectionSelect" class="form-control" onchange="filterTableBySection()">
                    <option value="" selected>Semua Section</option>
                    <!-- Options will be dynamically added via JavaScript -->
                </select>
            </div>
            
            <div class="keterangan">
                <h4>Keterangan Section:</h4>
                <ul>
                    <li>(A) Perlengkapan Keadaan Darurat</li>
                    <li>(B) Operasional</li>
                </ul>
            </div>
        <div style="overflow-x: auto;">
            <table id="checklist-k3-table" class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th>No</th>
                        <th>Section</th>
                        <th>Indikator K3</th>
                        <th>Jumlah Item</th>
                        <th>Expired Date</th>
                        <th>Check List Pemeriksaan</th>
                        <th>Rambu APAR</th>
                        <th>Kelengkapan Box Hydrant</th>
                        <th>Ruang Laktasi</th>
                        <th>Ruang P3K</th>
                        <th>Organik</th>
                        <th>Non-Organik</th>
                        <th>Limbah B3</th>
                        <th>Smoking Area</th>
                        <th>dll</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Data kecelakaan kerja akan diisi oleh script -->
                </tbody>
            </table>
        </div>

        <div style="height: 100px;"></div> <!-- Placeholder konten -->

    </div>

    <button id="scrollUpButton" onclick="scrollToTop()">&#8679;</button>

    <script nonce="<%= nonce %>" src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>


        <!-- JavaScript -->
        <script nonce="<%= nonce %>">
            // Tampilkan tombol ketika pengguna scroll lebih dari 20px ke bawah
            window.onscroll = function() {scrollFunction()};
    
            function scrollFunction() {
                if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                    document.getElementById("scrollUpButton").style.display = "block";
                } else {
                    document.getElementById("scrollUpButton").style.display = "none";
                }
            }
    
            // Fungsi untuk scroll ke atas
            function scrollToTop() {
                document.body.scrollTop = 0; // Untuk Safari
                document.documentElement.scrollTop = 0; // Untuk Chrome, Firefox, IE, dan Opera
            }
        </script>


    <script nonce="<%= nonce %>">
        document.getElementById('logoutbutton').addEventListener('click', async () => {
            try {
                const response = await axios.post('/logout');
                
                if (response.status === 200) {
                    // Redirect ke halaman login setelah logout berhasil
                    window.location.href = 'https://testing-website-rafi-fauzans-projects.vercel.app/index.html'; // Update dengan URL halaman login Anda
                }
            } catch (error) {
                console.error('Error logging out:', error);
                document.getElementById('warningMessage').textContent = 'Logout failed. Please try again.';
            }
        });
    </script>
    

    <script nonce="<%= nonce %>">
// Fetch data from backend
// Fetch data from backend
axios.get('getstrukturjagorawi')
    .then(response => {
        // Debugging: Tampilkan seluruh response data di console
        console.log('Full Response:', response.data);

        // Akses ke `showItems` dari response
        const data = response.data.showItems;

        if (Array.isArray(data)) {
            // Inisialisasi elemen HTML
            const ketuaElement = document.querySelector('.ketua');
            const sekretarisElement = document.querySelector('.sekretaris');

            // Mengisi nama untuk Ketua dan Sekretaris
            data.forEach(item => {
                if (item.jabatan === 'Ketua') {
                    ketuaElement.innerText = item.nama;
                } else if (item.jabatan === 'Sekretaris') {
                    sekretarisElement.innerText = item.nama;
                }
            });

            // Mengisi nama anggota secara langsung
            const anggotaNames1 = data.filter(item => item.jabatan === 'Anggota 1').map(item => item.nama);
            document.querySelector('.anggota1').innerText = anggotaNames1[0] || 'ANGGOTA 1';
            const anggotaNames2 = data.filter(item => item.jabatan === 'Anggota 2').map(item => item.nama);
            document.querySelector('.anggota2').innerText = anggotaNames2[0] || 'ANGGOTA 2';
            const anggotaNames3 = data.filter(item => item.jabatan === 'Anggota 3').map(item => item.nama);
            document.querySelector('.anggota3').innerText = anggotaNames3[0] || 'ANGGOTA 3';
            const anggotaNames4 = data.filter(item => item.jabatan === 'Anggota 4').map(item => item.nama);
            document.querySelector('.anggota4').innerText = anggotaNames4[0] || 'ANGGOTA 4';
            const anggotaNames5 = data.filter(item => item.jabatan === 'Anggota 5').map(item => item.nama);
            document.querySelector('.anggota5').innerText = anggotaNames5[0] || 'ANGGOTA 5';
        } else {
            console.error('Data is not in the expected format:', data);
        }
    })
    .catch(error => {
        console.error('Error fetching data:', error);
    });



    </script>
 
 <script nonce="<%= nonce %>">
    function showDeleteModalData() {
        $('#deleteModal').modal('show'); // Tampilkan modal pop-up
    }
    
    function deleteData() {
        const tahun = document.getElementById('tahun').value; // Ambil tahun dari input modal
        const bulan = document.getElementById('bulan').value; // Ambil bulan dari input modal
        
        if (!tahun && !bulan) {
            alert("Mohon pilih tahun dan bulan yang ingin dihapus.");
            return;
        }
        
        // Gunakan Axios untuk mengirim permintaan update (nullify data)
        axios.put(`/nullifydatajagorawi`, { 
            tahun: tahun, // Mengirimkan data tahun
            bulan: bulan  // Mengirimkan data bulan
        })
        .then(function (response) {
            alert("Data berhasil dihapus.");
            // Refresh tabel atau hapus baris dari DOM
            location.reload();
        })
        .catch(function (error) {
            alert("Terjadi kesalahan saat menghapus data.");
            console.error(error);
        });
        
        // Tutup modal setelah penghapusan
        $('#deleteModal').modal('hide');
    }
</script>


<script nonce="<%= nonce %>">
    function showDeleteModalPersonel() {
        $('#deleteModalPersonel').modal('show'); // Tampilkan modal pop-up
    }
    
    function deletePersonel() {
        const personel_k3_id = document.getElementById('personel_k3_id').value; // Ambil ID dari input modal
    
        if (!personel_k3_id) {
            alert("Mohon masukkan ID atau No data yang ingin dihapus.");
            return;
        }
    
        // Gunakan Axios untuk mengirim permintaan hapus
        axios.delete(`/deletepersoneljagorawi`, { 
            data: { personel_k3_id: personel_k3_id } // Mengirimkan data ID untuk dihapus
        })
        .then(function (response) {
            alert("Data berhasil dihapus.");
            // Refresh tabel atau hapus baris dari DOM
            location.reload();
        })
        .catch(function (error) {
            alert("Terjadi kesalahan saat menghapus data.");
            console.error(error);
        });
    
        // Tutup modal setelah penghapusan
        $('#deleteModal').modal('hide');
    }
</script>


<script nonce="<%= nonce %>">
    function showDeleteModalKecelakaan() {
        $('#deleteModalKecelakaan').modal('show'); // Tampilkan modal pop-up
    }
    
    function deleteKecelakaan() {
        const kecelakaan_kerja_id = document.getElementById('kecelakaan_kerja_id').value; // Ambil ID dari input modal
    
        if (!kecelakaan_kerja_id) {
            alert("Mohon masukkan ID atau No data yang ingin dihapus.");
            return;
        }
    
        // Gunakan Axios untuk mengirim permintaan hapus
        axios.delete(`/deletekecelakaanjagorawi`, { 
            data: { kecelakaan_kerja_id: kecelakaan_kerja_id } // Mengirimkan data ID untuk dihapus
        })
        .then(function (response) {
            alert("Data berhasil dihapus.");
            // Refresh tabel atau hapus baris dari DOM
            location.reload();
        })
        .catch(function (error) {
            alert("Terjadi kesalahan saat menghapus data.");
            console.error(error);
        });
    
        // Tutup modal setelah penghapusan
        $('#deleteModal').modal('hide');
    }
</script>


<script nonce="<%= nonce %>">
    function showDeleteModalKejadian() {
        $('#deleteModalKejadian').modal('show'); // Tampilkan modal pop-up
    }
    
    function deleteKejadian() {
        const kejadian_darurat_id = document.getElementById('kejadian_darurat_id').value; // Ambil ID dari input modal
    
        if (!kejadian_darurat_id) {
            alert("Mohon masukkan ID atau No data yang ingin dihapus.");
            return;
        }
    
        // Gunakan Axios untuk mengirim permintaan hapus
        axios.delete(`/deletekejadianjagorawi`, { 
            data: { kejadian_darurat_id: kejadian_darurat_id } // Mengirimkan data ID untuk dihapus
        })
        .then(function (response) {
            if (response.data.message === "Delete Success") {
                alert("Data berhasil dihapus.");
                // Refresh tabel atau hapus baris dari DOM
                location.reload();
            } else {
                alert("Data tidak ditemukan atau gagal dihapus.");
            }
        })
        .catch(function (error) {
            alert("Terjadi kesalahan saat menghapus data.");
            console.error(error);
        });
    
        // Tutup modal setelah penghapusan
        $('#deleteModal').modal('hide');
    }
</script>

    <script nonce="<%= nonce %>">
        document.getElementById('export-button').addEventListener('click', function() {
            // Ambil data tabel
            var table = document.getElementById('data-table');
            var wb = XLSX.utils.table_to_book(table, { sheet: "Sheet1" });
    
            // Ekspor ke file Excel
            XLSX.writeFile(wb, 'rekap_data_k3.xlsx');
        });
    </script>

    <script nonce="<%= nonce %>">
        document.getElementById('export-buttonPersonel').addEventListener('click', function() {
            // Ambil data tabel
            var table = document.getElementById('personel-k3-table');
            var wb = XLSX.utils.table_to_book(table, { sheet: "Sheet1" });
    
            // Ekspor ke file Excel
            XLSX.writeFile(wb, 'rekap_personel_k3.xlsx');
        });
    </script>

    <script nonce="<%= nonce %>">
        document.getElementById('export-buttonKecelakaan').addEventListener('click', function() {
            // Ambil data tabel
            var table = document.getElementById('kecelakaan-kerja-table');
            var wb = XLSX.utils.table_to_book(table, { sheet: "Sheet1" });
    
            // Ekspor ke file Excel
            XLSX.writeFile(wb, 'rekap_kecelakaan_k3.xlsx');
        });
    </script>

        <script nonce="<%= nonce %>">
        document.getElementById('export-buttonKejadian').addEventListener('click', function() {
            // Ambil data tabel
            var table = document.getElementById('kejadian-kerja-table');
            var wb = XLSX.utils.table_to_book(table, { sheet: "Sheet1" });
    
            // Ekspor ke file Excel
            XLSX.writeFile(wb, 'rekap_kejadian_kerja.xlsx');
        });
    </script>

<script nonce="<%= nonce %>">
    document.getElementById('export-buttonStruktur').addEventListener('click', function() {
        // Ambil data tabel
        var table = document.getElementById('struktur-organisasi-table');
        var wb = XLSX.utils.table_to_book(table, { sheet: "Sheet1" });

        // Ekspor ke file Excel
        XLSX.writeFile(wb, 'struktur_organisasi.xlsx');
    });
</script>

<!-- Bootstrap CSS -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
<!-- DataTables CSS -->
<link href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.min.css" rel="stylesheet">

<!-- jQuery (required for Bootstrap and DataTables) -->
<script nonce="<%= nonce %>" src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<!-- Bootstrap JS -->
<script nonce="<%= nonce %>" src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<!-- DataTables JS -->
<script nonce="<%= nonce %>" src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>



</body>
</html>